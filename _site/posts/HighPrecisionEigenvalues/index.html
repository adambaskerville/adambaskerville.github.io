<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="T&gt;T: High-Precision Eigenvalue Computations Made Efficient in C++" /><meta property="og:locale" content="en" /><meta name="description" content="The personal website of Adam Luke Baskerville Contains information and T&gt;T blog containing mathematics and science content" /><meta property="og:description" content="The personal website of Adam Luke Baskerville Contains information and T&gt;T blog containing mathematics and science content" /><link rel="canonical" href="https://adambaskerville.github.io/posts/HighPrecisionEigenvalues/" /><meta property="og:url" content="https://adambaskerville.github.io/posts/HighPrecisionEigenvalues/" /><meta property="og:site_name" content="Dr Adam Luke Baskerville" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-03T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="T&gt;T: High-Precision Eigenvalue Computations Made Efficient in C++" /><meta name="twitter:site" content="@SciBaskerville" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-06-09T13:49:33+01:00","datePublished":"2022-11-03T00:00:00+00:00","description":"The personal website of Adam Luke Baskerville Contains information and T&gt;T blog containing mathematics and science content","headline":"T&gt;T: High-Precision Eigenvalue Computations Made Efficient in C++","mainEntityOfPage":{"@type":"WebPage","@id":"https://adambaskerville.github.io/posts/HighPrecisionEigenvalues/"},"url":"https://adambaskerville.github.io/posts/HighPrecisionEigenvalues/"}</script><title>T>T: High-Precision Eigenvalue Computations Made Efficient in C++ | Dr Adam Luke Baskerville</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Dr Adam Luke Baskerville"><meta name="application-name" content="Dr Adam Luke Baskerville"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/js/data/mathjax.js"></script> <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://albaskerville.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://albaskerville.goatcounter.com/count" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/Baskerville_Bletchley_Crop.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Dr Adam Luke Baskerville</a><p class="site-subtitle fst-italic mb-0">Quantum Physicist <a href=https://www.kvantify.com/>@Kvantify</a></p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>T>T</span> </a><li class="nav-item"> <a href="/presentations/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PRESENTATIONS</span> </a><li class="nav-item"> <a href="/progchem/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PROGRAMMING COURSE</span> </a><li class="nav-item"> <a href="/publications/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PUBLICATIONS</span> </a><li class="nav-item"> <a href="/painting/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PAINTING</span> </a><li class="nav-item"> <a href="/astrophotography/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>ASTROPHOTOGRAPHY</span> </a><li class="nav-item"> <a href="/astro/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>ASTROPITOGRAPHY</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/adambaskerville" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/SciBaskerville" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['adamlukebaskerville','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>T>T: High-Precision Eigenvalue Computations Made Efficient in C++</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>T>T: High-Precision Eigenvalue Computations Made Efficient in C++</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1667433600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Nov 3, 2022 </time> </span> <span> Updated <time data-ts="1717937373" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 9, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/SciBaskerville">Adam Baskerville</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2030 words" > <em>11 min</em> read</span></div></div></div></header><div class="content"><p><strong>The Problem</strong></p><p>The Schrödinger equation is at the heart of quantum mechanics serving as a foundation for understanding the behavior of subatomic systems. In the context of quantum chemistry we normally solve the stationary state, time independent, non-relativistic Schrödinger equation, TISE, given by</p>\[\hat{H}\Psi = E\Psi.\]<p>In most practical applications we formulate our problems as a generalised eigenvalue problem, GEP, given as</p>\[\mathbf{H}\Psi = \lambda\mathbf{S}\Psi,\]<p>where \(\mathbf{H}\) represents our Hamiltonian matrix, \(\mathbf{S}\) the overlap matrix with \(\lambda\) being our energy eigenvalue. This matrix equation which is more amenable for computation may appear straightforward, however, solving it can often be very complex in practice. I have wrestled with these numerous times and have developed a toolbox of tricks to help solve them.</p><p>One of the key issues making GEPs difficult to solve is their numerical stability which can be thought of as how errors introduced during the execution of an algorithm affect the end result. There is a large variety of manipulations and tricks you can use to pre-process the input matrices or to reformulate the problem to reduce these errors but sometimes these are not enough. For anyone who has tried to calculated the eigenvalues for an excited state problem will be fully aware of these numerical difficulties…</p><p>One “last resort” solution involves increasing the computational precision from double precision (~16 digits) to quadruple precision (~32 digits). This approach is not preferred, as it is significantly slows down computation time. Quadruple precision is a non-native data type, which lacks support in nearly all programming languages where the <code class="language-plaintext highlighter-rouge">double</code> (or <code class="language-plaintext highlighter-rouge">long double</code>) data type offers the highest native precision.</p><p>How significant is the time penalty going from 16 to 32 or even 64 digit precision? This depends on the problem you are solving but can easily be 100x slower.</p><p>Is there a “least slowest” way of solving these GEP problems using quadruple, 32-digit precision in C++? In this post I will discuss one such method which I use.</p><p><strong>The Solution</strong></p><p>Many arbitrary precision algorithms and libraries have been developed using fixed precision arithmetic. They can be divided into two groups based on the philosophy used in how they represent numbers. Some libraries store numbers in a <em>multiple-digit</em> format, with a sequence of digits coupled with a single exponent, such as symbolic computation packages like <a href="https://www.maplesoft.com/">Maple</a> and <a href="https://www.wolfram.com/mathematica/">Mathematica</a>, or other very common libraries such as <a href="https://www.mpfr.org/">GNU MPFR</a>. These are the most common tools used by scientists to achieve higher precision in their calculations but they are <strong>slow</strong>, even though they are capable of achieving arbitrary precision.</p><p>An alternative approach is to store numbers in a <em>multiple-component</em> format, where a number is expressed as unevaluated sums of ordinary floating-point numbers, each with its own significand and exponent. As an example consider the two expressions \(x\) and \(y\) below which are each represented as the unevaluated sum of two IEEE double precision numbers</p>\[\begin{aligned} x &amp;= x_1 + x_2, \newline y &amp;= y_1 + y_2, \end{aligned}\]<p>Here, \(x_1, y_1\)​ are the leading components of their numbers \(x,y\) respectively, and \(x_2, y_2\)​ are the trailing component such that \(\rvert x_2 \rvert \leq \epsilon \rvert x_1 \rvert\rvert x_2 \rvert \leq \epsilon \rvert x_1 ​\rvert\) and \(\rvert y_2\rvert \leq \epsilon \rvert y_1 \rvert\rvert y_2 ​\rvert \leq \epsilon \rvert y_1 ​\rvert\), where \(\epsilon\) is the machine epsilon for double precision. Each subsequent component \((x_2,x_3,x_4​\) etc… captures increasingly smaller parts of the number, ensuring very high precision.</p><p>For most scientific applications <strong>arbitrary</strong> precision is not required but just a small multiple of double precision (such as twice or quadruple). The algorithms for this kind of precision can be made significantly faster than those for arbitrary precision. One such library which implements this idea is the <a href="https://www.davidhbailey.com/dhbsoftware/">QD library</a> developed by Bailey <em>et al.</em> which implements “double-double” precision, twice the double precision and “quad-double” precision, four times the double precision. These are <em>much</em> faster than the standard MPFR data types a lot of scientists may use when desiring higher precision. When solving these GEPs I do not need 200 digits of precision, 32 will suffice which these data types are optimised specifically for whereas the <code class="language-plaintext highlighter-rouge">MPFR</code> types have to work across any specified precision.</p><p>Let’s write a short code implementing these aforementioned data types. I linked to the original author’s page above for the QD library however due to the age of the code base some tweaks are required to some of the header files in order to make it work on modern architectures (if you need to know these feel free to message me). <em>However</em> we are in luck as there is a header only version of this repository called <a href="https://github.com/lhprojects/qdpp/tree/master">qdpp</a>. This makes using the QD library <strong>much</strong> easier as there is no need to install it and the syntax is more up to date with modern C++ standards.</p><p>Next we need to select a C++ linear algebra library of which there are <a href="https://en.wikipedia.org/wiki/Comparison_of_linear_algebra_libraries"><em>many</em></a>. My personal favourite is <a href="https://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a> as it is easily extensible to custom numeric types which other libraries lack. Another major advantage is that it can be used as a header only library so once again no installation required; we can just use the header files. Download these two libraries before continuing.</p><p>Next we import the libraries we need and setup the namespace for Eigen.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;Eigen/Eigenvalues&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;mpreal.h&gt;</span><span class="c1"> // header for GNU MPFR</span><span class="cp">
#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;complex&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;qd/qd_real.h&gt;</span><span class="c1"> // header for quad-double (qd_real) </span><span class="cp">
#include</span> <span class="cpf">&lt;qd/dd_math.h&gt;</span><span class="c1"> // header for double-double (dd_real)</span><span class="cp">
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</pre></table></code></div></div><p>Next we are going to create some templates specialized for different precision types. Read <a href="https://learn.microsoft.com/en-us/cpp/cpp/templates-cpp?view=msvc-170">here</a> for more information on why I love using templates.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1">// define template structure for precision</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="p">;</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="o">&lt;</span><span class="n">dd_real</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="c1">// DoubleDouble-precision, 32-digits</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="o">&lt;</span><span class="n">qd_real</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span> <span class="c1">// QuadDouble-precision, 64-digits</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="o">&lt;</span><span class="n">mpfr</span><span class="o">::</span><span class="n">mpreal</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="c1">// mpreal set to 32 digit precision for comparison with dd_real</span>
<span class="p">};</span>
</pre></table></code></div></div><p>Next we create our function to calculate the eigenvalues which we call <code class="language-plaintext highlighter-rouge">CalcEigenvals</code>. Note how we use a <strong>function template</strong> which are functions that can operate with generic types, in this example <code class="language-plaintext highlighter-rouge">Real</code>. This allows us to create a function template whose functionality can be adapted to more than one type or class without repeating the entire code for each type. Handy! Check out the comments for a description of what each line does</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Real</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">CalcEigenvals</span><span class="p">(</span><span class="kt">int</span> <span class="n">mat_size</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// define matrix and vector types used in code</span>
    <span class="c1">// MatrixXz defined as Eigen matrix with generic type Real using two dimensions</span>
    <span class="c1">// VectorXz defined as Eigen vector with generic type Real using one dimension</span>
    <span class="k">typedef</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">RowMajor</span><span class="o">&gt;</span>  <span class="n">MatrixXz</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;</span>  <span class="n">VectorXz</span><span class="p">;</span>

    <span class="c1">// set the random seed using srand, used by Eigen to generate random matrices </span>
    <span class="c1">// this will make the matrices the same each time for each data type</span>
    <span class="n">srand</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>

    <span class="c1">// generate random square matrices using Eigen specified using our custom MatrixXz type</span>
    <span class="n">MatrixXz</span> <span class="n">lhs_mat</span> <span class="o">=</span> <span class="n">MatrixXz</span><span class="o">::</span><span class="n">Random</span><span class="p">(</span><span class="n">mat_size</span><span class="p">,</span> <span class="n">mat_size</span><span class="p">);</span>
    <span class="n">srand</span><span class="p">(</span><span class="mi">26</span><span class="p">);</span>
    <span class="n">MatrixXz</span> <span class="n">rhs_mat</span> <span class="o">=</span> <span class="n">MatrixXz</span><span class="o">::</span><span class="n">Random</span><span class="p">(</span><span class="n">mat_size</span><span class="p">,</span> <span class="n">mat_size</span><span class="p">);</span>

    <span class="c1">// calculate eigenvalues using Eigen GEP solver</span>
    <span class="n">GeneralizedSelfAdjointEigenSolver</span><span class="o">&lt;</span><span class="n">MatrixXz</span><span class="o">&gt;</span> <span class="n">es</span><span class="p">(</span><span class="n">lhs_mat</span><span class="p">,</span> <span class="n">rhs_mat</span><span class="p">,</span> <span class="n">EigenvaluesOnly</span><span class="p">);</span>
    <span class="n">VectorXz</span> <span class="n">EigenvalueVec</span> <span class="o">=</span> <span class="n">es</span><span class="p">.</span><span class="n">eigenvalues</span><span class="p">();</span>

    <span class="c1">// extract first eigenvalue from vector (because why not?)</span>
    <span class="n">Real</span> <span class="n">ExtractedEigenValue</span> <span class="o">=</span> <span class="n">EigenvalueVec</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// call the precision templates so output precision matches precision of data type</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">setprecision</span><span class="p">(</span><span class="n">Precision</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">ExtractedEigenValue</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Finally we create <code class="language-plaintext highlighter-rouge">int main</code> to call this function.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>	
    <span class="c1">// catch if no matrix size is provided by the user</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Usage: "</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" &lt;matrix_size&gt;"</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// use command line argument to set size of matrices</span>
    <span class="kt">int</span> <span class="n">mat_size</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

    <span class="c1">// generate eigenvalues using dd_real precision, 32 digits</span>
    <span class="n">CalcEigenvals</span><span class="o">&lt;</span><span class="n">dd_real</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mat_size</span><span class="p">);</span>

    <span class="c1">// generate eigenvalues using qd_real precision, 64 digits</span>
    <span class="n">CalcEigenvals</span><span class="o">&lt;</span><span class="n">qd_real</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mat_size</span><span class="p">);</span>

    <span class="c1">// Specify the global precision to be used (in bits) for mpreal: </span>
    <span class="c1">// 16bit = half, </span>
    <span class="c1">// 32bit = single, </span>
    <span class="c1">// 64bit = double, </span>
    <span class="c1">// 128bit = quadruple</span>
    <span class="n">mpfr</span><span class="o">::</span><span class="n">mpreal</span><span class="o">::</span><span class="n">set_default_prec</span><span class="p">(</span><span class="mi">128</span><span class="p">);</span> 

    <span class="c1">// generate eigenvalues using mpreal precision, 32 digits</span>
    <span class="n">CalcEigenvals</span><span class="o">&lt;</span><span class="n">mpfr</span><span class="o">::</span><span class="n">mpreal</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mat_size</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Compiling code</strong></p><p>To compile this code on my MacBook M1 I used the following two commands</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>g++-14 <span class="nt">-c</span> <span class="s2">"dd_qd_mpfr_eigenvalues.cpp"</span> <span class="nt">-g</span> <span class="nt">-O3</span> <span class="nt">-fopenmp</span> <span class="nt">-std</span><span class="o">=</span>c++20 <span class="nt">-o</span> dd_qd_mpfr_eigenvalues.cpp.o <span class="nt">-I</span>/link_to_eigen_folder <span class="nt">-I</span>/link_to_mpfr_header_file <span class="nt">-I</span>/opt/homebrew/include/ <span class="nt">-I</span>/link_to_qdpp_folder <span class="nt">-L</span>/opt/homebrew/lib/ <span class="nt">-DEIGEN_DEFAULT_DENSE_INDEX_TYPE</span><span class="o">=</span>int

g++-14 dd_qd_mpfr_eigenvalues.cpp.o <span class="nt">-o</span> dd_qd_mpfr_eigenvalues <span class="nt">-L</span>/opt/homebrew/lib/ <span class="nt">-lmpfr</span> <span class="nt">-lgmp</span> <span class="nt">-lm</span> <span class="nt">-Wl</span>, <span class="nt">-DEIGEN_DEFAULT_DENSE_INDEX_TYPE</span><span class="o">=</span>int <span class="nt">-fopenmp</span>
</pre></table></code></div></div><p>We are done! This shows how easy it is to use these optimised, higher precision types as drop-in replacements for standard <code class="language-plaintext highlighter-rouge">float</code> or <code class="language-plaintext highlighter-rouge">double</code> when using the Eigen C++ library. You can run this code by calling the binary name and providing a matrix dimension.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dd_qd_mpfr_eigenvalues 10
</pre></table></code></div></div><p>and this will return the generalised eigenvalues calculated using each of the 3 data types on randomly generated matrices.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">-3</span>.32361249928752178695374578519557e+07 <span class="c"># dd_real</span>
<span class="nt">-3</span>.3236124992875217869537457851945383735713881932771345078904322360e+07 <span class="c"># qd_real</span>
<span class="nt">-33236124</span>.992875217869537457851945 <span class="c"># mpreal</span>
</pre></table></code></div></div><p>So how much faster is <code class="language-plaintext highlighter-rouge">dd_real</code> compared to <code class="language-plaintext highlighter-rouge">mpreal</code> set to 32-digit precision? The plot below shows data I calculated for the CPU time it took to calculate all the eigenvalues of the helium atom with increasing basis set size (matrix size) using a near exact numerical solution of the TISE based on an improvement on the seminal work of <a href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.112.1649">Pekeris</a>.</p><p>This data was originally generated on my old iMac 4GHz Intel Quad Core i7 with 32GB 1867MHz DDR3 Memory.</p><p><a href="/assets/img/HighPrecisionEigenvalues/DoubleDouble_vs_MPFR.png" class="popup img-link shimmer"><img src="/assets/img/HighPrecisionEigenvalues/DoubleDouble_vs_MPFR.png" alt="Desktop View" loading="lazy"></a></p><p>This shows very clearly how much faster the <code class="language-plaintext highlighter-rouge">dd_real</code> data type is compared to <code class="language-plaintext highlighter-rouge">mpreal</code> for an equivalent 32-digit precision calculation. For a 3000 x 3000 matrix the <code class="language-plaintext highlighter-rouge">dd_real</code> data type is 20 times faster than the equivalent <code class="language-plaintext highlighter-rouge">mpreal</code> calculation and the computational scaling past a basis size of 4000 is <strong>much</strong> better for <code class="language-plaintext highlighter-rouge">dd_real</code>.</p><p>Even more interesting is that calculating all the eigenvalues at 64-digit precision using <code class="language-plaintext highlighter-rouge">qd_real</code> is faster than the <code class="language-plaintext highlighter-rouge">mpreal</code> 32-digit precision calculation!</p><p><strong>Conclusion</strong></p><p>If you require 32 or 64 digit precision for a calculation, do <strong>not</strong> use libraries which implement arbitrary precision data types such as GNU MPFR. Use the optimised operations found within the QD library which offer much better performance on the exact same calculation.</p><p><strong>Complete code</strong></p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;Eigen/Eigenvalues&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;mpreal.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;complex&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;qd/qd_real.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;qd/dd_math.h&gt;</span><span class="cp">
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">Eigen</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="c1">// define template structure for precision</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="p">;</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="o">&lt;</span><span class="n">dd_real</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="c1">// DoubleDouble-precision</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="o">&lt;</span><span class="n">qd_real</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span> <span class="c1">// QuadDouble-precision</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">Precision</span><span class="o">&lt;</span><span class="n">mpfr</span><span class="o">::</span><span class="n">mpreal</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="c1">// mpreal at 32 digit precision</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Real</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">CalcEigenvals</span><span class="p">(</span><span class="kt">int</span> <span class="n">mat_size</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Define matrix and vector types used in program. Xmp ending corresponds to mpreal, Xz endings correspond to dd_Real</span>
    <span class="k">typedef</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">RowMajor</span><span class="o">&gt;</span>  <span class="n">MatrixXz</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">Real</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;</span>  <span class="n">VectorXz</span><span class="p">;</span>

    <span class="c1">// generate random square matrices</span>
    <span class="n">MatrixXz</span> <span class="n">lhs_mat</span> <span class="o">=</span> <span class="n">MatrixXz</span><span class="o">::</span><span class="n">Random</span><span class="p">(</span><span class="n">mat_size</span><span class="p">,</span> <span class="n">mat_size</span><span class="p">);</span>
    <span class="n">MatrixXz</span> <span class="n">rhs_mat</span> <span class="o">=</span> <span class="n">MatrixXz</span><span class="o">::</span><span class="n">Random</span><span class="p">(</span><span class="n">mat_size</span><span class="p">,</span> <span class="n">mat_size</span><span class="p">);</span>

    <span class="c1">// calculate eigenvalues using Eigen</span>
    <span class="n">GeneralizedSelfAdjointEigenSolver</span><span class="o">&lt;</span><span class="n">MatrixXz</span><span class="o">&gt;</span> <span class="n">es</span><span class="p">(</span><span class="n">lhs_mat</span><span class="p">,</span> <span class="n">rhs_mat</span><span class="p">,</span> <span class="n">EigenvaluesOnly</span><span class="p">);</span>
    <span class="n">VectorXz</span> <span class="n">EigenvalueVec</span> <span class="o">=</span> <span class="n">es</span><span class="p">.</span><span class="n">eigenvalues</span><span class="p">();</span>

    <span class="c1">// extract first eigenvalue from vector</span>
    <span class="n">Real</span> <span class="n">ExtractedEigenValue</span> <span class="o">=</span> <span class="n">EigenvalueVec</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">setprecision</span><span class="p">(</span><span class="n">Precision</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">ExtractedEigenValue</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>	
    <span class="kt">int</span> <span class="n">mat_size</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

	<span class="n">CalcEigenvals</span><span class="o">&lt;</span><span class="n">dd_real</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mat_size</span><span class="p">);</span>

    <span class="n">CalcEigenvals</span><span class="o">&lt;</span><span class="n">qd_real</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mat_size</span><span class="p">);</span>

    <span class="c1">// Specify the global precision to be used (in bits): </span>
    <span class="c1">// 16bit = half, </span>
    <span class="c1">// 32bit = single, </span>
    <span class="c1">// 64bit = double, </span>
    <span class="c1">// 128bit = quadruple</span>
    <span class="n">mpfr</span><span class="o">::</span><span class="n">mpreal</span><span class="o">::</span><span class="n">set_default_prec</span><span class="p">(</span><span class="mi">128</span><span class="p">);</span> 

    <span class="n">CalcEigenvals</span><span class="o">&lt;</span><span class="n">mpfr</span><span class="o">::</span><span class="n">mpreal</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mat_size</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/science/" class="post-tag no-text-decoration" >science</a> <a href="/tags/mathematics/" class="post-tag no-text-decoration" >mathematics</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> <a href="/tags/eigenvalues/" class="post-tag no-text-decoration" >eigenvalues</a> <a href="/tags/precision/" class="post-tag no-text-decoration" >precision</a> <a href="/tags/doubledouble/" class="post-tag no-text-decoration" >doubledouble</a> <a href="/tags/quaddouble/" class="post-tag no-text-decoration" >quaddouble</a> <a href="/tags/mpfr/" class="post-tag no-text-decoration" >mpfr</a> <a href="/tags/mpreal/" class="post-tag no-text-decoration" >mpreal</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=T%3ET:%20High-Precision%20Eigenvalue%20Computations%20Made%20Efficient%20in%20C++%20-%20Dr%20Adam%20Luke%20Baskerville&url=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FHighPrecisionEigenvalues%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=T%3ET:%20High-Precision%20Eigenvalue%20Computations%20Made%20Efficient%20in%20C++%20-%20Dr%20Adam%20Luke%20Baskerville&u=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FHighPrecisionEigenvalues%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FHighPrecisionEigenvalues%2F&text=T%3ET:%20High-Precision%20Eigenvalue%20Computations%20Made%20Efficient%20in%20C++%20-%20Dr%20Adam%20Luke%20Baskerville" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/am1bcc_speedup/">T>T: Turbocharging AM1BCC Charge Calculations</a><li class="text-truncate lh-lg"> <a href="/posts/BuffonNeedle/">T>T: Buffon's Needle: Estimating π using Toothpicks</a><li class="text-truncate lh-lg"> <a href="/posts/HighPrecisionEigenvalues/">T>T: High-Precision Eigenvalue Computations Made Efficient in C++</a><li class="text-truncate lh-lg"> <a href="/posts/DearpyguiCompilation/">T>T: Compiling DearPyGui on Raspberry Pi 32-bit OS</a><li class="text-truncate lh-lg"> <a href="/posts/Introduction-post/">T>T: Introduction</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">science</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">Mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">Programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/chemistry/">chemistry</a> <a class="post-tag btn btn-outline-primary" href="/tags/matplotlib/">matplotlib</a> <a class="post-tag btn btn-outline-primary" href="/tags/length/">length</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/DearpyguiCompilation/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1654210800" data-df="ll" > Jun 3, 2022 </time><h4 class="pt-0 my-2">T>T: Compiling DearPyGui on Raspberry Pi 32-bit OS</h4><div class="text-muted"><p>The Problem DearPyGui, available at https://github.com/hoffstadt/DearPyGui, is a robust and speedy Graphical User Interface (GUI) toolkit designed for Python, boasting minimal dependencies. I’ve b...</p></div></div></a></article><article class="col"> <a href="/posts/EnergyLevel/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1649286000" data-df="ll" > Apr 7, 2022 </time><h4 class="pt-0 my-2">T>T: LaTeX for Energy Level Transition Diagrams</h4><div class="text-muted"><p>The Problem During my PhD I worked with chemists who would need to create energy level transition diagrams for use in presentations and publications such as those seen below. This process took t...</p></div></div></a></article><article class="col"> <a href="/posts/MontyHall/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1648166400" data-df="ll" > Mar 25, 2022 </time><h4 class="pt-0 my-2">T>T: Behind the Doors of the Monty Hall Puzzle</h4><div class="text-muted"><p>Try the code yourself! Click the following button to launch an ipython notebook on Google Colab which implements the code developed in this post: The Monty Hall problem poses a probability puzz...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/ForLoops/" class="btn btn-outline-primary" aria-label="Older" ><p>T>T: Effortless Parallel For Loops in Python</p></a> <a href="/posts/BuffonNeedle/" class="btn btn-outline-primary" aria-label="Newer" ><p>T>T: Buffon's Needle: Estimating π using Toothpicks</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/SciBaskerville">Adam Baskerville</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">science</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">Mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">Programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/chemistry/">chemistry</a> <a class="post-tag btn btn-outline-primary" href="/tags/matplotlib/">matplotlib</a> <a class="post-tag btn btn-outline-primary" href="/tags/length/">length</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
