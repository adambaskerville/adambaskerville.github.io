<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="T&gt;T: Buffon’s Needle: Estimating π using Toothpicks" /><meta property="og:locale" content="en" /><meta name="description" content="The personal website of Adam Luke Baskerville Contains information and T&gt;T blog containing mathematics and science content" /><meta property="og:description" content="The personal website of Adam Luke Baskerville Contains information and T&gt;T blog containing mathematics and science content" /><link rel="canonical" href="https://adambaskerville.github.io/posts/BuffonNeedle/" /><meta property="og:url" content="https://adambaskerville.github.io/posts/BuffonNeedle/" /><meta property="og:site_name" content="Dr Adam Luke Baskerville" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-08T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="T&gt;T: Buffon’s Needle: Estimating π using Toothpicks" /><meta name="twitter:site" content="@SciBaskerville" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-14T00:15:46+01:00","datePublished":"2023-02-08T00:00:00+00:00","description":"The personal website of Adam Luke Baskerville Contains information and T&gt;T blog containing mathematics and science content","headline":"T&gt;T: Buffon’s Needle: Estimating π using Toothpicks","mainEntityOfPage":{"@type":"WebPage","@id":"https://adambaskerville.github.io/posts/BuffonNeedle/"},"url":"https://adambaskerville.github.io/posts/BuffonNeedle/"}</script><title>T>T: Buffon's Needle: Estimating π using Toothpicks | Dr Adam Luke Baskerville</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Dr Adam Luke Baskerville"><meta name="application-name" content="Dr Adam Luke Baskerville"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/js/data/mathjax.js"></script> <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://albaskerville.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://albaskerville.goatcounter.com/count" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/Baskerville_Bletchley_Crop.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Dr Adam Luke Baskerville</a><p class="site-subtitle fst-italic mb-0">Quantum Physicist <a href=https://www.kvantify.com/>@Kvantify</a></p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>T>T</span> </a><li class="nav-item"> <a href="/presentations/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PRESENTATIONS</span> </a><li class="nav-item"> <a href="/progchem/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PROGRAMMING COURSE</span> </a><li class="nav-item"> <a href="/publications/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PUBLICATIONS</span> </a><li class="nav-item"> <a href="/painting/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PAINTING</span> </a><li class="nav-item"> <a href="/astrophotography/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>ASTROPHOTOGRAPHY</span> </a><li class="nav-item"> <a href="/astro/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>ASTROPITOGRAPHY</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/adambaskerville" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/SciBaskerville" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['adamlukebaskerville','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>T>T: Buffon's Needle: Estimating π using Toothpicks</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>T>T: Buffon's Needle: Estimating π using Toothpicks</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1675814400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 8, 2023 </time> </span> <span> Updated <time data-ts="1744586146" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 14, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/SciBaskerville">Adam Baskerville</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4147 words" > <em>23 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">T>T: Buffon's Needle: Estimating π using Toothpicks</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">T>T: Buffon's Needle: Estimating π using Toothpicks</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h1 id="try-the-code-yourself">Try the code yourself!</h1><p>Click the following button to launch an ipython notebook on Google Colab which implements the code developed in this post:</p><p><a href="https://colab.research.google.com/github/adambaskerville/adambaskerville.github.io/blob/master/_posts/BuffonsNeedleCode/BuffonsNeedle.ipynb" class="img-link shimmer" ><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" loading="lazy"></a></p><h2 id="the-problem"><span class="me-2">The Problem</span><a href="#the-problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Have you ever wondered if you could calculate \(\pi\) by simply dropping toothpicks on the floor? In the 18th century, French mathematician Georges-Louis Leclerc, Comte de Buffon, wondered exactly that. Not with toothpicks specifically but using needles. However the principle remains the same, and it results in an interesting demonstration of how probability and geometry can intertwine.</p><p>Imagine you have a floor made of parallel wooden floorboards, each of equal width. If you drop a toothpick on this floor, what is the probability that the toothpick will cross one of the lines between the floorboards? How can we use this to calculate \(\pi\)?</p><p>In this post we are going to answer this question.</p><h2 id="the-mathematics"><span class="me-2">The Mathematics</span><a href="#the-mathematics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>We have parallel floorboards of width \(d\)<li>We drop a toothpick of length \(l\) (where \(l \le d\))<li>We want to know the probability, \(P\), that the toothpick crosses a line, the separation between two floorboards</ul><p>Buffon proved that this probability equals</p>\[P = \frac{2l}{\pi d}\]<p>Note how \(\pi\) appears in this formula. Rearranging this equation to solve for \(\pi\) gives</p>\[\pi = \frac{2l}{P d}\]<p>This means we can estimate \(\pi\) by:</p><ol><li>Dropping lots of toothpicks<li>Counting how many cross between two floorboards<li>Plugging that empirical probability into this formula</ol><p>The more toothpicks we drop, the closer our estimate should get to the true value of \(\pi\). This is one of the earliest examples of a Monte Carlo method using random sampling to obtain numerical results.</p><p>For those that want to see the full derivation, see the section at the end of this post.</p><p>Buffon first proposed this problem in 1733, but published the solution in 1777, and I would consider it one of oldest problems in geometric probability, preceding much of the formal development of probability theory.</p><h2 id="simulating-the-experiment-with-python"><span class="me-2">Simulating the Experiment with Python</span><a href="#simulating-the-experiment-with-python" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Rather than dropping thousands of actual toothpicks (and spending hours cleaning them up), let’s use Python to simulate the experiment.</p><p>We are going to create a function in order to run a Buffon needle simulation and we will break down the code section by section. Here is a rough thought process for what we are aiming to do:</p><p>Let’s break down how our simulation works:</p><ol><li><p><strong>Setting Up the Experiment</strong>: We define the distance between lines and the length of our toothpicks.</p><li><strong>Random Needle Drops</strong>: For each toothpick, we randomly determine:<ul><li>Its position (x, y coordinates)<li>Its angle \(\theta\) relative to the parallel lines</ul><li><p><strong>Detecting Crossings</strong>: A toothpick crosses a line if its endpoints are on opposite sides of any line.</p><li><p><strong>Calculating \(\pi\)</strong>: We apply Buffon’s formula to estimate \(\pi\) based on the proportion of toothpicks that cross lines.</p><li><strong>Visualization</strong>: We create plots showing both the physical experiment (toothpicks on lines) and how our estimate of \(\pi\) converges as we drop more toothpicks.</ol><h2 id="1-imports-and-setup"><span class="me-2">1. Imports and Setup</span><a href="#1-imports-and-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">from</span> <span class="n">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span> <span class="n">matplotlib.gridspec</span> <span class="k">as</span> <span class="n">gridspec</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">numpy</code> provides numerical computation functions<li><code class="language-plaintext highlighter-rouge">matplotlib.pyplot</code> handles plotting and visualization<li><code class="language-plaintext highlighter-rouge">FuncAnimation</code> creates animations from matplotlib plots<li><code class="language-plaintext highlighter-rouge">Line2D</code> is used to create legend elements<li><code class="language-plaintext highlighter-rouge">gridspec</code> allows for complex subplot grid layouts<li><code class="language-plaintext highlighter-rouge">typing</code> provides type hints for better code clarity</ul><h2 id="2-needle-simulation-function"><span class="me-2">2. Needle Simulation Function</span><a href="#2-needle-simulation-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">simulate_buffon_needle_batch</span><span class="p">(</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">needle_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">line_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">floor_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
</pre></table></code></div></div><p>This function simulates dropping a batch of needles onto the floor and counts how many cross lines.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="c1"># generate random positions and angles for needles
</span>    <span class="n">x_positions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor_width</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
    <span class="n">y_positions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>creates random x-positions across the floor width<li>creates random angles between 0 and \(\pi\) radians<li>creates random y-positions for visualization (between 0 and 10)</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    <span class="c1"># for calculation: find distance to nearest line
</span>    <span class="n">nearest_line_positions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="n">x_positions</span> <span class="o">/</span> <span class="n">line_distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">line_distance</span>
    <span class="n">distances_to_nearest_line</span> <span class="o">=</span> <span class="n">x_positions</span> <span class="o">-</span> <span class="n">nearest_line_positions</span>
</pre></table></code></div></div><ul><li>calculates the position of the nearest line to the left of each needle<li>calculates how far each needle is from its nearest line</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>    <span class="c1"># determine which needles cross a line
</span>    <span class="n">needle_half_length</span> <span class="o">=</span> <span class="n">needle_length</span> <span class="o">/</span> <span class="mi">2</span>
    
    <span class="n">crossing_left</span> <span class="o">=</span> <span class="n">distances_to_nearest_line</span> <span class="o">&lt;</span> <span class="n">needle_half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
    <span class="n">crossing_right</span> <span class="o">=</span> <span class="n">distances_to_nearest_line</span> <span class="o">&gt;</span> <span class="n">line_distance</span> <span class="o">-</span> <span class="n">needle_half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
    <span class="n">crossings</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">crossing_left</span> <span class="o">|</span> <span class="n">crossing_right</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>a needle crosses a line if its distance to the nearest line is less than \((L/2)\sin\theta\)<li>or if its distance to the next line to the right is less than \((L/2)\sin\theta\)<li>the total number of crossings is counted</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="c1"># prepare needle data for visualization
</span>    <span class="n">needles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">thetas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">crossings</span><span class="p">,</span> <span class="n">needles</span>
</pre></table></code></div></div><ul><li>packages the needle position and angle data for visualization<li>returns both the crossing count and needle data</ul><h2 id="3-animation-creation-function"><span class="me-2">3. Animation Creation Function</span><a href="#3-animation-creation-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">create_buffon_animation</span><span class="p">(</span>
    <span class="n">total_needles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">needle_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="n">line_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">floor_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span>
    <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sh">'</span><span class="s">buffon_needle_animation.mp4</span><span class="sh">'</span>
<span class="p">):</span>
</pre></table></code></div></div><p>This function creates the animation by dropping needles in batches and updating the visualization.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>    <span class="c1"># helper function to format the error text with color
</span>    <span class="k">def</span> <span class="nf">error_color_text</span><span class="p">(</span><span class="n">error_percent</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Format the error text with color.</span><span class="sh">"""</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="sh">'</span><span class="s">$</span><span class="se">\\</span><span class="s">color{{</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s">}}{{</span><span class="si">{</span><span class="n">error_percent</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="se">\\</span><span class="s">%}}$</span><span class="sh">'</span>
        
</pre></table></code></div></div><ul><li>a nested helper function that creates colored text for the error display<li>uses LaTeX formatting so the color can be displayed in matplotlib</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>    <span class="c1"># calculate frames needed
</span>    <span class="n">frames</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">total_needles</span> <span class="o">//</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">fps</span> <span class="o">*</span> <span class="n">duration</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>determines how many animation frames to create<li>limits it to either the total number of needle batches or the maximum frames for the duration</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    <span class="c1"># set up the figure with two subplots
</span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="p">.</span><span class="nc">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></table></code></div></div><ul><li>creates a figure with a 12x8 inch size<li>sets up a grid with two rows (top row twice as tall as bottom row)</ul><h2 id="4-setting-up-the-needle-plot"><span class="me-2">4. Setting Up the Needle Plot</span><a href="#4-setting-up-the-needle-plot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="c1"># needle plot
</span>    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">floor_width</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">X position</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Y position</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">Buffon</span><span class="sh">'</span><span class="s">s Needle Experiment</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>creates the top subplot for showing the needles<li>sets the axis limits with some padding<li>adds labels and a title</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="c1"># draw lines
</span>    <span class="n">num_lines</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">floor_width</span> <span class="o">/</span> <span class="n">line_distance</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">):</span>
        <span class="n">ax1</span><span class="p">.</span><span class="nf">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="n">line_distance</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>calculates how many lines fit on the floor<li>draws each line as a vertical line at regular intervals</ul><h2 id="5-setting-up-the-convergence-plot"><span class="me-2">5. Setting Up the Convergence Plot</span><a href="#5-setting-up-the-convergence-plot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>    <span class="c1"># convergence plot
</span>    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_needles</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">)</span>  <span class="c1"># range around π for visibility
</span>    <span class="n">ax2</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="s">π = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Number of Needles</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Estimated π</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Convergence to π</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</pre></table></code></div></div><ul><li>creates the bottom subplot for tracking how π estimate converges<li>sets the x-axis to show values up to the total number of needles<li>sets the y-axis to focus on values around π<li>adds a horizontal line at the true value of π for reference<li>adds labels, grid, and legend</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>    <span class="c1"># add second y-axis for error percentage
</span>    <span class="n">ax3</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">.</span><span class="nf">twinx</span><span class="p">()</span>
    <span class="n">ax3</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Error (%)</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>  <span class="c1"># error percentage range
</span>    <span class="n">ax3</span><span class="p">.</span><span class="nf">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>creates a secondary y-axis on the right side of the convergence plot<li>sets it up to show the error percentage in green<li>limits the range to 0-25%</ul><h2 id="6-initializing-plot-elements"><span class="me-2">6. Initializing Plot Elements</span><a href="#6-initializing-plot-elements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>    <span class="c1"># initialize plots
</span>    <span class="n">needle_lines</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># will hold all needle lines
</span>    
    <span class="c1"># convergence lines
</span>    <span class="n">pi_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Estimated π</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">error_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax3</span><span class="p">.</span><span class="nf">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="sh">'</span><span class="s">g-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Error %</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">pi_estimates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">error_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="p">[]</span>
</pre></table></code></div></div><ul><li>creates an empty list to track all needle lines<li>creates empty line plots for the π estimates and error values<li>creates empty lists to store the data for these plots</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="c1"># add legend to needle plot
</span>    <span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Non-crossing needles</span><span class="sh">'</span><span class="p">),</span>
        <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Crossing needles</span><span class="sh">'</span><span class="p">),</span>
        <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Lines</span><span class="sh">'</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper right</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>creates legend elements for the needle plot<li>shows which color represents crossing vs. non-crossing needles</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>    <span class="c1"># text for statistics
</span>    <span class="n">stats_text</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sh">''</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="p">.</span><span class="n">transAxes</span><span class="p">,</span> 
                         <span class="n">verticalalignment</span><span class="o">=</span><span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                         <span class="n">bbox</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="sh">'</span><span class="s">round</span><span class="sh">'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">wheat</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
    
    <span class="c1"># create a prominent display for π estimate and error
</span>    <span class="n">pi_display</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="sh">''</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="sh">'</span><span class="s">center</span><span class="sh">'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="sh">'</span><span class="s">center</span><span class="sh">'</span><span class="p">,</span>
                         <span class="n">bbox</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="sh">'</span><span class="s">round</span><span class="sh">'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">lightblue</span><span class="sh">'</span><span class="p">,</span> 
                                  <span class="n">edgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>creates a text box in the upper left of the needle plot for statistics<li>creates a prominent text display in the center of the figure for the π estimate and error</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="c1"># animation variables
</span>    <span class="n">total_crossings</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_dropped</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">needles_data</span> <span class="o">=</span> <span class="p">[]</span>
</pre></table></code></div></div><ul><li>initializes counters for total crossings and needles dropped<li>creates an empty list to store all needle data</ul><h2 id="7-animation-initialization-function"><span class="me-2">7. Animation Initialization Function</span><a href="#7-animation-initialization-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="c1"># animation initialization function
</span>    <span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
        <span class="n">pi_line</span><span class="p">.</span><span class="nf">set_data</span><span class="p">([],</span> <span class="p">[])</span>
        <span class="n">error_line</span><span class="p">.</span><span class="nf">set_data</span><span class="p">([],</span> <span class="p">[])</span>
        <span class="n">stats_text</span><span class="p">.</span><span class="nf">set_text</span><span class="p">(</span><span class="sh">''</span><span class="p">)</span>
        <span class="n">pi_display</span><span class="p">.</span><span class="nf">set_text</span><span class="p">(</span><span class="sh">''</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">pi_line</span><span class="p">,</span> <span class="n">error_line</span><span class="p">,</span> <span class="n">stats_text</span><span class="p">,</span> <span class="n">pi_display</span><span class="p">]</span>
</pre></table></code></div></div><ul><li>sets up the initial state of the animation<li>clears all lines and text<li>returns the list of artists that will be animated</ul><h2 id="8-animation-update-function"><span class="me-2">8. Animation Update Function</span><a href="#8-animation-update-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    <span class="c1"># animation update function
</span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">total_crossings</span><span class="p">,</span> <span class="n">total_dropped</span><span class="p">,</span> <span class="n">needles_data</span>
</pre></table></code></div></div><ul><li>this function is called for each frame of the animation<li>uses nonlocal to access variables from the outer function scope</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>        <span class="c1"># drop a new batch of needles
</span>        <span class="n">crossings</span><span class="p">,</span> <span class="n">new_needles</span> <span class="o">=</span> <span class="nf">simulate_buffon_needle_batch</span><span class="p">(</span>
            <span class="n">batch_size</span><span class="p">,</span> <span class="n">needle_length</span><span class="p">,</span> <span class="n">line_distance</span><span class="p">,</span> <span class="n">floor_width</span>
        <span class="p">)</span>
        
        <span class="c1"># update totals
</span>        <span class="n">total_crossings</span> <span class="o">+=</span> <span class="n">crossings</span>
        <span class="n">total_dropped</span> <span class="o">+=</span> <span class="n">batch_size</span>
        <span class="n">needles_data</span><span class="p">.</span><span class="nf">extend</span><span class="p">(</span><span class="n">new_needles</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>simulates dropping a new batch of needles<li>updates the running totals of crossings and needles<li>adds the new needle data to the list</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>        <span class="c1"># calculate current π estimate
</span>        <span class="k">if</span> <span class="n">total_crossings</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">current_pi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">needle_length</span> <span class="o">*</span> <span class="n">total_dropped</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">total_crossings</span> <span class="o">*</span> <span class="n">line_distance</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_pi</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
        
        <span class="c1"># calculate error
</span>        <span class="n">error_percent</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">current_pi</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span>
</pre></table></code></div></div><ul><li>calculates the current estimate of π using Buffon’s formula<li>calculates the percentage error compared to the true value</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>        <span class="c1"># update convergence plot
</span>        <span class="n">x_data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">total_dropped</span><span class="p">)</span>
        <span class="n">pi_estimates</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">current_pi</span><span class="p">)</span>
        <span class="n">error_values</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">error_percent</span><span class="p">)</span>
        <span class="n">pi_line</span><span class="p">.</span><span class="nf">set_data</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">pi_estimates</span><span class="p">)</span>
        <span class="n">error_line</span><span class="p">.</span><span class="nf">set_data</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">error_values</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>adds the new data points to the lists<li>updates the line plots with the current data</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>        <span class="c1"># clear previous needles and plot new ones
</span>        <span class="k">for</span> <span class="n">needle_line</span> <span class="ow">in</span> <span class="n">needle_lines</span><span class="p">:</span>
            <span class="n">needle_line</span><span class="p">.</span><span class="nf">remove</span><span class="p">()</span>
        <span class="n">needle_lines</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
</pre></table></code></div></div><ul><li>removes all previously drawn needles<li>clears the list of needle lines</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>        <span class="c1"># half-length of the needle
</span>        <span class="n">half_length</span> <span class="o">=</span> <span class="n">needle_length</span> <span class="o">/</span> <span class="mi">2</span>
        
        <span class="c1"># draw all needles up to now (up to a maximum to prevent slowdown)
</span>        <span class="n">max_display_needles</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">needles_data</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># limit to prevent slowdown
</span>        <span class="n">display_needles</span> <span class="o">=</span> <span class="n">needles_data</span><span class="p">[</span><span class="o">-</span><span class="n">max_display_needles</span><span class="p">:]</span>
</pre></table></code></div></div><ul><li>calculates the half-length of the needles<li>limits the number of displayed needles to prevent slowdown<li>selects the most recent needles to display</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>        <span class="n">crossing_count</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">display_needles</span><span class="p">:</span>
            <span class="c1"># calculate needle endpoints
</span>            <span class="n">dx</span> <span class="o">=</span> <span class="n">half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">dy</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
</pre></table></code></div></div><ul><li>resets the crossing counter<li>calculates the endpoints of each needle based on its center position and angle</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>            <span class="c1"># check if needle crosses a line
</span>            <span class="n">crosses</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">line_positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">line_distance</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">line_pos</span> <span class="ow">in</span> <span class="n">line_positions</span><span class="p">:</span>
                <span class="nf">if </span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">line_pos</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">line_pos</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">crosses</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">crossing_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">break</span>
</pre></table></code></div></div><ul><li>checks if each needle crosses any of the lines<li>a needle crosses a line if its endpoints are on opposite sides of the line<li>counts how many needles are crossing</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>            <span class="c1"># plot needle
</span>            <span class="k">if</span> <span class="n">crosses</span><span class="p">:</span>
                <span class="n">needle_line</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">needle_line</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="n">needle_lines</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">needle_line</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>draws each needle as a line between its endpoints<li>colors crossing needles red and non-crossing needles blue<li>adds each line to the list for later removal</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>        <span class="c1"># update statistics text
</span>        <span class="n">stats_text</span><span class="p">.</span><span class="nf">set_text</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Needles: </span><span class="si">{</span><span class="n">total_dropped</span><span class="si">}</span><span class="se">\n</span><span class="sh">'</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Crossings: </span><span class="si">{</span><span class="n">total_crossings</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="n">total_crossings</span><span class="o">/</span><span class="n">total_dropped</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">%)</span><span class="sh">'</span>
        <span class="p">)</span>
</pre></table></code></div></div><ul><li>updates the statistics text box with current needle and crossing counts</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>        <span class="c1"># update the prominent π display
</span>        <span class="c1"># color the error based on its magnitude (red for high error, green for low)
</span>        <span class="k">if</span> <span class="n">error_percent</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">error_color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">green</span><span class="sh">'</span>
        <span class="k">elif</span> <span class="n">error_percent</span> <span class="o">&lt;</span> <span class="mf">5.0</span><span class="p">:</span>
            <span class="n">error_color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">orange</span><span class="sh">'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error_color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">red</span><span class="sh">'</span>
            
        <span class="n">pi_display</span><span class="p">.</span><span class="nf">set_text</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">π ≈ </span><span class="si">{</span><span class="n">current_pi</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="se">\n</span><span class="sh">'</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Error: </span><span class="si">{</span><span class="nf">error_color_text</span><span class="p">(</span><span class="n">error_percent</span><span class="p">,</span> <span class="n">error_color</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span>
        <span class="p">)</span>
</pre></table></code></div></div><ul><li>chooses a color for the error text based on its magnitude<li>updates the prominent π display with the current estimate and error</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>        <span class="k">return</span> <span class="p">[</span><span class="n">pi_line</span><span class="p">,</span> <span class="n">error_line</span><span class="p">,</span> <span class="n">stats_text</span><span class="p">,</span> <span class="n">pi_display</span><span class="p">]</span> <span class="o">+</span> <span class="n">needle_lines</span>
</pre></table></code></div></div><ul><li>returns all the artists that need to be redrawn in the next frame</ul><h2 id="9-creating-and-saving-the-animation"><span class="me-2">9. Creating and Saving the Animation</span><a href="#9-creating-and-saving-the-animation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="c1"># create animation
</span>    <span class="n">animation</span> <span class="o">=</span> <span class="nc">FuncAnimation</span><span class="p">(</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1000</span><span class="o">/</span><span class="n">fps</span>
    <span class="p">)</span>
</pre></table></code></div></div><ul><li>creates the animation by repeatedly calling the update function<li>blit=True makes the animation more efficient by only redrawing changed parts<li>interval controls the time between frames in milliseconds</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="c1"># save animation
</span>    <span class="n">animation</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="sh">'</span><span class="s">ffmpeg</span><span class="sh">'</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Animation saved to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">animation</span>
</pre></table></code></div></div><ul><li>saves the animation to a file using ffmpeg<li>closes the figure to free up memory<li>prints a confirmation message<li>returns the animation object</ul><h2 id="10-main-code-execution"><span class="me-2">10. Main Code Execution</span><a href="#10-main-code-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility
</span>    
    <span class="c1"># create the animation
</span>    <span class="n">animation</span> <span class="o">=</span> <span class="nf">create_buffon_animation</span><span class="p">(</span>
        <span class="n">total_needles</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">needle_length</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">line_distance</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">output_file</span><span class="o">=</span><span class="sh">'</span><span class="s">buffon_needle_animation.mp4</span><span class="sh">'</span>
    <span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Animation complete!</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>sets a random seed for reproducible results<li>calls the animation function with specific parameters<li>prints a completion message when done</ul><h2 id="key-concepts-in-the-implementation"><span class="me-2">Key Concepts in the Implementation</span><a href="#key-concepts-in-the-implementation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s break down the important concepts in our code:</p><ol><li><p><strong>Random Needle Generation</strong>: Each needle is defined by its center position \((x, y)\) and angle \(\theta\).</p><li><p><strong>Crossing Detection</strong>: A needle crosses a line if the distance from its center to the nearest line is less than</p>\[(L/2)\sin\theta\]<p>in either direction.</p><li><p><strong>Pi Calculation</strong>: We use the formula</p>\[\pi = \frac{2L}{P·d}\]<p>where P is the empirical probability of crossing (crossings/total needles).</p><li><p><strong>Visualization</strong>: We highlight crossing needles in red and non-crossing needles in blue.</p><li><p><strong>Convergence Analysis</strong>: We track how our estimate approaches \(\pi\) as we increase the number of needles, showing that Monte Carlo methods require large sample sizes for accuracy.</p></ol><h2 id="full-code"><span class="me-2">Full Code</span><a href="#full-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">from</span> <span class="n">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Callable</span>

<span class="k">def</span> <span class="nf">simulate_buffon_needle</span><span class="p">(</span>
    <span class="n">num_needles</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">needle_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">line_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">floor_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
    <span class="sh">"""</span><span class="s">
    Simulate Buffon</span><span class="sh">'</span><span class="s">s needle experiment.
    
    Parameters:
    -----------
    num_needles : int
        Number of needles to drop
    needle_length : float
        Length of each needle (should be &lt;= line_distance)
    line_distance : float
        Distance between parallel lines
    floor_width : float
        Total width of the floor for visualization
    
    Returns:
    --------
    Tuple[float, int, List[Tuple[float, float, float]]]
        (estimated_pi, crossings, needles)
        where needles is a list of (x, y, theta) for each needle
    </span><span class="sh">"""</span>
    <span class="c1"># validate needle length
</span>    <span class="k">if</span> <span class="n">needle_length</span> <span class="o">&gt;</span> <span class="n">line_distance</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">Needle length must be less than or equal to line distance</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># random positions and angles for needles
</span>    <span class="c1"># for visualization: x positions across the entire floor
</span>    <span class="n">x_positions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">floor_width</span><span class="p">,</span> <span class="n">num_needles</span><span class="p">)</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num_needles</span><span class="p">)</span>
    
    <span class="c1"># calculate y positions (0-10 for visualization)
</span>    <span class="n">y_positions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num_needles</span><span class="p">)</span>
    
    <span class="c1"># for calculation: find distance to nearest line for each needle
</span>    <span class="c1"># lines are at positions 0, line_distance, 2*line_distance, etc.
</span>    <span class="n">nearest_line_positions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="n">x_positions</span> <span class="o">/</span> <span class="n">line_distance</span><span class="p">)</span> <span class="o">*</span> <span class="n">line_distance</span>
    <span class="n">distances_to_nearest_line</span> <span class="o">=</span> <span class="n">x_positions</span> <span class="o">-</span> <span class="n">nearest_line_positions</span>
    
    <span class="c1"># determine which needles cross a line
</span>    <span class="n">needle_half_length</span> <span class="o">=</span> <span class="n">needle_length</span> <span class="o">/</span> <span class="mi">2</span>
    
    <span class="c1"># a needle crosses a line if distance to nearest line &lt; (L/2)*sin(theta)
</span>    <span class="c1"># or if distance to next line &gt; line_distance - (L/2)*sin(theta)
</span>    <span class="n">crossing_left</span> <span class="o">=</span> <span class="n">distances_to_nearest_line</span> <span class="o">&lt;</span> <span class="n">needle_half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
    <span class="n">crossing_right</span> <span class="o">=</span> <span class="n">distances_to_nearest_line</span> <span class="o">&gt;</span> <span class="n">line_distance</span> <span class="o">-</span> <span class="n">needle_half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
    <span class="n">crossings</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">crossing_left</span> <span class="o">|</span> <span class="n">crossing_right</span><span class="p">)</span>
    
    <span class="c1"># calculate estimated π
</span>    <span class="k">if</span> <span class="n">crossings</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">estimated_pi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">needle_length</span> <span class="o">*</span> <span class="n">num_needles</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">crossings</span> <span class="o">*</span> <span class="n">line_distance</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">estimated_pi</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="c1"># prepare needle data for visualization
</span>    <span class="n">needles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">thetas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_needles</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">estimated_pi</span><span class="p">,</span> <span class="n">crossings</span><span class="p">,</span> <span class="n">needles</span>

<span class="k">def</span> <span class="nf">plot_experiment</span><span class="p">(</span>
    <span class="n">needles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> 
    <span class="n">line_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">max_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
    <span class="n">needle_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">highlight_crossings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="p">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">
    Visualize the Buffon</span><span class="sh">'</span><span class="s">s needle experiment.
    
    Parameters:
    -----------
    needles : List[Tuple[float, float, float]]
        List of (x, y, theta) for each needle
    line_distance : float
        Distance between parallel lines
    max_y : float
        Maximum y value for visualization
    needle_length : float
        Length of each needle
    highlight_crossings : bool
        Whether to highlight needles that cross lines
        
    Returns:
    --------
    plt.Figure
        The matplotlib figure object
    </span><span class="sh">"""</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    
    <span class="c1"># draw parallel lines
</span>    <span class="n">num_lines</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">/</span> <span class="n">line_distance</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">.</span><span class="nf">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="n">line_distance</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    
    <span class="c1"># half-length of the needle
</span>    <span class="n">half_length</span> <span class="o">=</span> <span class="n">needle_length</span> <span class="o">/</span> <span class="mi">2</span>
    
    <span class="c1"># draw needles
</span>    <span class="n">crossing_needles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">non_crossing_needles</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">needles</span><span class="p">:</span>
        <span class="c1"># calculate needle endpoints
</span>        <span class="n">dx</span> <span class="o">=</span> <span class="n">half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">half_length</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">dy</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
        
        <span class="c1"># check if needle crosses a line
</span>        <span class="n">crosses</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">line_positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">line_distance</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_lines</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">line_pos</span> <span class="ow">in</span> <span class="n">line_positions</span><span class="p">:</span>
            <span class="c1"># if the needle endpoints are on opposite sides of the line
</span>            <span class="nf">if </span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">line_pos</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">line_pos</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">crosses</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="n">crosses</span><span class="p">:</span>
            <span class="n">crossing_needles</span><span class="p">.</span><span class="nf">append</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">non_crossing_needles</span><span class="p">.</span><span class="nf">append</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)])</span>
    
    <span class="c1"># plot non-crossing needles
</span>    <span class="k">for</span> <span class="n">needle</span> <span class="ow">in</span> <span class="n">non_crossing_needles</span><span class="p">:</span>
        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">needle</span>
        <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># plot crossing needles
</span>    <span class="k">for</span> <span class="n">needle</span> <span class="ow">in</span> <span class="n">crossing_needles</span><span class="p">:</span>
        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">needle</span>
        <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">],</span> <span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    
    <span class="c1"># add legend
</span>    <span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Non-crossing needles</span><span class="sh">'</span><span class="p">),</span>
        <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Crossing needles</span><span class="sh">'</span><span class="p">),</span>
        <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Lines</span><span class="sh">'</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper right</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="c1"># set axis limits and labels
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="n">num_lines</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">line_distance</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">X position</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Y position</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">Buffon</span><span class="sh">'</span><span class="s">s Needle Experiment Visualization</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span> <span class="nf">run_buffon_experiment</span><span class="p">(</span>
    <span class="n">max_needles</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> 
    <span class="n">step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> 
    <span class="n">needle_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">line_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="n">floor_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">range</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
    <span class="sh">"""</span><span class="s">
    Run Buffon</span><span class="sh">'</span><span class="s">s needle experiment with increasing numbers of needles.
    
    Parameters:
    -----------
    max_needles : int
        Maximum number of needles to simulate
    step : int
        Step size for increasing number of needles
    needle_length : float
        Length of each needle
    line_distance : float
        Distance between parallel lines
    floor_width : float
        Width of the entire floor for visualization
        
    Returns:
    --------
    Tuple[range, List[float]]
        (needle_counts, pi_estimates) where needle_counts is a range object
        and pi_estimates is a list of estimated π values
    </span><span class="sh">"""</span>
    <span class="n">needle_counts</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">max_needles</span> <span class="o">+</span> <span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">pi_estimates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">needle_counts</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">Simulating needle drops</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">estimated_pi</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nf">simulate_buffon_needle</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">needle_length</span><span class="p">,</span> <span class="n">line_distance</span><span class="p">,</span> <span class="n">floor_width</span><span class="p">)</span>
        <span class="n">pi_estimates</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">estimated_pi</span><span class="p">)</span>
        <span class="n">errors</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">estimated_pi</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># calculate percentage error
</span>    
    <span class="c1"># plot results
</span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1"># plot 1: estimated π values
</span>    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">needle_counts</span><span class="p">,</span> <span class="n">pi_estimates</span><span class="p">,</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="s">π = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Estimated π</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Estimated Value of π vs. Number of Needles</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">needle_counts</span><span class="p">,</span> <span class="n">pi_estimates</span>

<span class="c1"># example usage
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility
</span>    
    <span class="c1"># simulation parameters
</span>    <span class="n">needle_length</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">line_distance</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">floor_width</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># width of the entire floor
</span>    
    <span class="c1"># small visualization example
</span>    <span class="n">num_needles_viz</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">estimated_pi</span><span class="p">,</span> <span class="n">crossings</span><span class="p">,</span> <span class="n">needles</span> <span class="o">=</span> <span class="nf">simulate_buffon_needle</span><span class="p">(</span>
        <span class="n">num_needles_viz</span><span class="p">,</span> 
        <span class="n">needle_length</span><span class="p">,</span> 
        <span class="n">line_distance</span><span class="p">,</span> 
        <span class="n">floor_width</span>
    <span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Dropped </span><span class="si">{</span><span class="n">num_needles_viz</span><span class="si">}</span><span class="s"> needles, </span><span class="si">{</span><span class="n">crossings</span><span class="si">}</span><span class="s"> crossed lines</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Estimated π = </span><span class="si">{</span><span class="n">estimated_pi</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> (Actual π = </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># visualize the experiment
</span>    <span class="n">fig</span> <span class="o">=</span> <span class="nf">plot_experiment</span><span class="p">(</span><span class="n">needles</span><span class="p">,</span> <span class="n">line_distance</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">needle_length</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">buffon_needle_visualization.png</span><span class="sh">'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    
    <span class="c1"># run a larger experiment to see convergence
</span>    <span class="n">needle_counts</span><span class="p">,</span> <span class="n">pi_estimates</span> <span class="o">=</span> <span class="nf">run_buffon_experiment</span><span class="p">(</span>
        <span class="n">max_needles</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> 
        <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
        <span class="n">needle_length</span><span class="o">=</span><span class="n">needle_length</span><span class="p">,</span> 
        <span class="n">line_distance</span><span class="o">=</span><span class="n">line_distance</span>
    <span class="p">)</span>
    
    <span class="c1"># print final estimate
</span>    <span class="n">final_estimate</span> <span class="o">=</span> <span class="n">pi_estimates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Final estimate with </span><span class="si">{</span><span class="n">needle_counts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s"> needles: π ≈ </span><span class="si">{</span><span class="n">final_estimate</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: </span><span class="si">{</span><span class="nf">abs</span><span class="p">(</span><span class="n">final_estimate</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="nf">abs</span><span class="p">(</span><span class="n">final_estimate</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">%)</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">buffon_pi_convergence.png</span><span class="sh">'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="results-and-convergence"><span class="me-2">Results and Convergence</span><a href="#results-and-convergence" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we run our simulation with an increasing number of toothpicks, we can observe something cool happening: our estimate of \(\pi\) gradually converges to the true value as the sample size grows.</p><p>Here is the putput from running a simulation using 100000 toothpicks.</p><p><a href="/assets/img/buffons_needle/BuffonNeedleFloor.png" class="popup img-link shimmer"><img src="/assets/img/buffons_needle/BuffonNeedleFloor.png" alt="Desktop View" loading="lazy"></a></p><p>Here is the plot showing the numerical convergence to the value of \(\pi\).</p><p><a href="/assets/img/buffons_needle/buffon_pi_convergence.png" class="popup img-link shimmer"><img src="/assets/img/buffons_needle/buffon_pi_convergence.png" alt="Desktop View" loading="lazy"></a></p><p>With just a few hundred toothpicks, our estimate might be off by 10% or more. But with tens of thousands of toothpicks, we typically get within 0.1% of the actual value of \(\pi\).</p><p>Just for fun here is an animation showing the convergence of the value of \(\pi\) as we drop more and more toothpicks.</p><p><a href="/assets/img/buffons_needle/buffon_needle_animation.gif" class="popup img-link shimmer"><img src="/assets/img/buffons_needle/buffon_needle_animation.gif" alt="Desktop View" loading="lazy"></a></p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I found this particular problem interesting owing to the overlap of probability and geometry. The fact that \(\pi\), this transcendental number that appears throughout mathematics, can be approximated by simply dropping sticks on the floor is fascinating. I hope you enjoyed this breakdown of the problem and our implementation.</p><p>The next time you spill toothpicks on your kitchen floor, don’t just sweep them up. Count how many cross the tiles, and see how close you can approximate the value of \(\pi\).</p><h2 id="deriving-the-formula"><span class="me-2">Deriving the Formula</span><a href="#deriving-the-formula" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here we discuss how Buffon derived this equation. When Buffon solved this problem in the 18th century, he used geometric probability, a field that was relatively new at the time. His approach is very elegant hence I wanted to include it here.</p><p><strong>Setting Up the Parameters</strong>:</p><ul><li>The position of a toothpick can be completely described by two independent variables:<ul><li>The distance $x$ from the center of the toothpick to the nearest floorboard edge (ranges from 0 to \(d/2\))<li>The angle \(\theta\) between the toothpick and the edge (ranges from 0 to \(\pi\))</ul></ul><p><strong>Geometric Analysis</strong>:</p><ul><li>For any given angle \(\theta\), the toothpick will cross between two floorboards if the distance from its centre to the nearest line is less than \(\frac{l\sin\theta}{2}\)<li>To visualize this: imagine a toothpick at angle \(\theta\). The “reach” of this toothpick from its centre point is \((l/2)\sin\theta\) in the direction perpendicular to the lines.</ul><p><strong>Calculating the Probability</strong>:</p><ul><li><p>For a fixed angle \(\theta\), the toothpick crosses between two floorboards when</p>\[x &lt; \frac{l\sin\theta}{2}\]<li><p>Since $x$ is uniformly distributed between 0 and \(d/2\), the probability of crossing at this specific angle is</p>\[P(\text{crossing} | \theta) = \frac{l\sin\theta}{d}\]<li><p>To get the overall probability, we need to integrate this over all possible angles</p>\[P = \frac{2}{\pi} \int\limits_{0}^{\pi/2} \frac{l\sin\theta}{d} d\theta\]</ul><p>The 2/\(\pi\) factor comes from normalizing over the range of angles. Solving this integral</p>\[\begin{aligned} P &amp;= \frac{2}{\pi} \frac{l}{d} \left[-\cos(\theta)\right]_{0}^{\pi/2} \\ P &amp;= \frac{2}{\pi} \frac{l}{d} \left[0 - (-1)\right] \\ P &amp;= \frac{2}{\pi} \frac{l}{d} 1 \\ P &amp;= \frac{2l}{\pi d} \end{aligned}\]<p>What makes this result so elegant is that \(\pi\) appears naturally in the calculation because:</p><ul><li>The range of possible angles (0 to \(\pi\)) introduces a factor of \(\pi\) in the denominator<li>The integration of \(\sin\theta\) over this range brings in trigonometric properties related to circles<li>The averaging over all possible orientations essentially captures the ratio of a circle’s circumference to its diameter - which is precisely the definition of \(\pi\)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/science/" class="post-tag no-text-decoration" >science</a> <a href="/tags/mathematics/" class="post-tag no-text-decoration" >mathematics</a> <a href="/tags/buffons/" class="post-tag no-text-decoration" >buffons</a> <a href="/tags/pi/" class="post-tag no-text-decoration" >pi</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=T%3ET:%20Buffon's%20Needle:%20Estimating%20%CF%80%20using%20Toothpicks%20-%20Dr%20Adam%20Luke%20Baskerville&url=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FBuffonNeedle%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=T%3ET:%20Buffon's%20Needle:%20Estimating%20%CF%80%20using%20Toothpicks%20-%20Dr%20Adam%20Luke%20Baskerville&u=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FBuffonNeedle%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FBuffonNeedle%2F&text=T%3ET:%20Buffon's%20Needle:%20Estimating%20%CF%80%20using%20Toothpicks%20-%20Dr%20Adam%20Luke%20Baskerville" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/am1bcc_speedup/">T>T: Turbocharging AM1BCC Charge Calculations</a><li class="text-truncate lh-lg"> <a href="/posts/BuffonNeedle/">T>T: Buffon's Needle: Estimating π using Toothpicks</a><li class="text-truncate lh-lg"> <a href="/posts/HighPrecisionEigenvalues/">T>T: High-Precision Eigenvalue Computations Made Efficient in C++</a><li class="text-truncate lh-lg"> <a href="/posts/DearpyguiCompilation/">T>T: Compiling DearPyGui on Raspberry Pi 32-bit OS</a><li class="text-truncate lh-lg"> <a href="/posts/Introduction-post/">T>T: Introduction</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">science</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">Mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">Programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/chemistry/">chemistry</a> <a class="post-tag btn btn-outline-primary" href="/tags/matplotlib/">matplotlib</a> <a class="post-tag btn btn-outline-primary" href="/tags/length/">length</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/ForLoops/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1661468400" data-df="ll" > Aug 26, 2022 </time><h4 class="pt-0 my-2">T>T: Effortless Parallel For Loops in Python</h4><div class="text-muted"><p>Try the code yourself! Click the following button to launch an ipython notebook on Google Colab which implements the code developed in this post: The Problem What is the easiest way to paralle...</p></div></div></a></article><article class="col"> <a href="/posts/DearpyguiCompilation/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1654210800" data-df="ll" > Jun 3, 2022 </time><h4 class="pt-0 my-2">T>T: Compiling DearPyGui on Raspberry Pi 32-bit OS</h4><div class="text-muted"><p>The Problem DearPyGui, available at https://github.com/hoffstadt/DearPyGui, is a robust and speedy Graphical User Interface (GUI) toolkit designed for Python, boasting minimal dependencies. I’ve b...</p></div></div></a></article><article class="col"> <a href="/posts/EnergyLevel/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1649286000" data-df="ll" > Apr 7, 2022 </time><h4 class="pt-0 my-2">T>T: LaTeX for Energy Level Transition Diagrams</h4><div class="text-muted"><p>The Problem During my PhD I worked with chemists who would need to create energy level transition diagrams for use in presentations and publications such as those seen below. This process took t...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/HighPrecisionEigenvalues/" class="btn btn-outline-primary" aria-label="Older" ><p>T>T: High-Precision Eigenvalue Computations Made Efficient in C++</p></a> <a href="/posts/am1bcc_speedup/" class="btn btn-outline-primary" aria-label="Newer" ><p>T>T: Turbocharging AM1BCC Charge Calculations</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/SciBaskerville">Adam Baskerville</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">science</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">Mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">Programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/chemistry/">chemistry</a> <a class="post-tag btn btn-outline-primary" href="/tags/matplotlib/">matplotlib</a> <a class="post-tag btn btn-outline-primary" href="/tags/length/">length</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
