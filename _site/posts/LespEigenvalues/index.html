<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="T&gt;T: When Double Precision is Not Enough" /><meta property="og:locale" content="en" /><meta name="description" content="Using greater than double precision to calculate the eigenvalues of the lesp matrix." /><meta property="og:description" content="Using greater than double precision to calculate the eigenvalues of the lesp matrix." /><link rel="canonical" href="https://adambaskerville.github.io/posts/LespEigenvalues/" /><meta property="og:url" content="https://adambaskerville.github.io/posts/LespEigenvalues/" /><meta property="og:site_name" content="Dr Adam Luke Baskerville" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-12-02T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="T&gt;T: When Double Precision is Not Enough" /><meta name="twitter:site" content="@SciBaskerville" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-10-05T15:19:21+01:00","datePublished":"2019-12-02T00:00:00+00:00","description":"Using greater than double precision to calculate the eigenvalues of the lesp matrix.","headline":"T&gt;T: When Double Precision is Not Enough","mainEntityOfPage":{"@type":"WebPage","@id":"https://adambaskerville.github.io/posts/LespEigenvalues/"},"url":"https://adambaskerville.github.io/posts/LespEigenvalues/"}</script><title>T>T: When Double Precision is Not Enough | Dr Adam Luke Baskerville</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Dr Adam Luke Baskerville"><meta name="application-name" content="Dr Adam Luke Baskerville"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/js/data/mathjax.js"></script> <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://albaskerville.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://albaskerville.goatcounter.com/count" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/Baskerville_Bletchley_Crop.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Dr Adam Luke Baskerville</a><p class="site-subtitle fst-italic mb-0">Quantum Physicist <a href=https://www.kvantify.com/>@Kvantify</a></p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>T>T</span> </a><li class="nav-item"> <a href="/presentations/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PRESENTATIONS</span> </a><li class="nav-item"> <a href="/progchem/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PROGRAMMING COURSE</span> </a><li class="nav-item"> <a href="/publications/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PUBLICATIONS</span> </a><li class="nav-item"> <a href="/painting/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>PAINTING</span> </a><li class="nav-item"> <a href="/astrophotography/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>ASTROPHOTOGRAPHY</span> </a><li class="nav-item"> <a href="/astro/" class="nav-link"> <i class="fa-fw fas fa-newspaper"></i> <span>ASTROPITOGRAPHY</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/adambaskerville" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/SciBaskerville" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['adamlukebaskerville','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>T>T: When Double Precision is Not Enough</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>T>T: When Double Precision is Not Enough</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1575244800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 2, 2019 </time> </span> <span> Updated <time data-ts="1633443561" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 5, 2021 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/SciBaskerville">Adam Baskerville</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="978 words" > <em>5 min</em> read</span></div></div></div></header><div class="content"><h1 id="try-the-code-yourself">Try the code yourself!</h1><p>Click the following button to launch an ipython notebook on Google Colab which implements the code developed in this post:</p><p><a href="https://colab.research.google.com/github/adambaskerville/adambaskerville.github.io/blob/master/_posts/EigenvaluesCode/Eigenvalues.ipynb" class="img-link shimmer" ><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" loading="lazy"></a></p><h1 id="the-problem">The Problem:</h1><p>We want to solve the following standard eigenvalue problem</p><p>\[ \mathbf{A}\Psi = \lambda\Psi, \]</p><p>where \(\mathbf{A}\) is the <code class="language-plaintext highlighter-rouge">lesp</code> matrix, \(\Psi\) is the eigenvector and \(\lambda\) the eigenvalue. The <code class="language-plaintext highlighter-rouge">lesp</code> matrix is a tridiagonal matrix with real, sensitive eigenvalues, with a \(5 \times 5\) example seen in equation (1).</p><p>\[ \mathbf{M} = \begin{pmatrix} -5 &amp; 2 &amp; 0 &amp; 0 &amp; 0 \\<br /> \frac{1}{2} &amp; -7 &amp; 3 &amp; 0 &amp; 0 \\<br /> 0 &amp; \frac{1}{3} &amp; -9 &amp; 4 &amp; 0 \\<br /> 0 &amp; 0 &amp; \frac{1}{4} &amp; -11 &amp; 5 \\<br /> 0 &amp; 0 &amp; 0 &amp; \frac{1}{5} &amp; -13 \\<br /> \end{pmatrix} \tag{1} \]</p><p>We are going to numerically show that the eigenvalues of a matrix \(\mathbf{A}\) are equal to the eigenvalues of its matrix transpose, \(\mathbf{A}^T\), easily proved as follows</p>\[\text{det}(\mathbf{A}^T - \lambda \mathbf{I}) = \text{det}((\mathbf{A} - \lambda \mathbf{I})^T) = \text{det}(\mathbf{A} - \lambda \mathbf{I}),\]<p>where \(\mathbf{I}\) is the identity matrix. If you do not want to write your own function to construct the <code class="language-plaintext highlighter-rouge">lesp</code> matrix then you are in luck, there is a python library, <a href="https://pypi.org/project/rogues/">rogues</a>, which has one built in.</p><p>The following python code calculates the eigenvalues of \(\mathbf{A}\) and \(\mathbf{A}^T\) and displays them using <a href="https://seaborn.pydata.org/">seaborn</a>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">rogues</span> <span class="kn">import</span> <span class="n">lesp</span>
<span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span> 
<span class="kn">from</span> <span class="n">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigvals</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">color_palette</span><span class="p">(</span><span class="sh">"</span><span class="s">bright</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Dimension of matrix
</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># get lesp matrix
</span><span class="n">A</span> <span class="o">=</span> <span class="nf">lesp</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c1"># Transpose matrix A
</span><span class="n">AT</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">T</span>
<span class="c1"># Calculate eigenvalues of A
</span><span class="n">Aev</span> <span class="o">=</span> <span class="nf">eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="c1"># Calculate eigenvalues of A^T
</span><span class="n">ATev</span> <span class="o">=</span> <span class="nf">eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
<span class="c1"># Extract real and imaginary parts of A
</span><span class="n">A_X</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Aev</span><span class="p">]</span>
<span class="n">A_Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Aev</span><span class="p">]</span>
<span class="c1"># Extract real and imaginary parts of A^T
</span><span class="n">AT_X</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ATev</span><span class="p">]</span>
<span class="n">AT_Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ATev</span><span class="p">]</span>

<span class="c1"># Plot
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">A_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">A_Y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\mathbf{A}$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">AT_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">AT_Y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\mathbf{A}^T$</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># Give axis labels
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">real</span><span class="sh">'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">imag</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># Draw legend
</span><span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">pyplot</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></table></code></div></div><p>This produces the following plot of the eigenvalues for a \(100 \times 100 \) matrix.</p><p><a href="/assets/img/Lesp_scipy.png" class="popup img-link shimmer"><img src="/assets/img/Lesp_scipy.png" alt="Desktop View" loading="lazy"></a></p><p>Something is wrong, most of the eigenvalues of matrix \(\mathbf{A}\) are not equal to the eigenvalues of \(\mathbf{A}^T\), even though they should be identical. Some of them also have complex components! There is no error with the program; this discrepancy is caused by a loss of <strong>numerical accuracy</strong> in the eigenvalue calculation due to the limitation of hardware double precision (16-digit).</p><h1 id="the-solution">The Solution:</h1><p>The scipy <code class="language-plaintext highlighter-rouge">eigvals</code> function calls LAPACK routine <a href="http://www.netlib.org/lapack/lapack-3.1.1/html/dgeev.f.html"><code class="language-plaintext highlighter-rouge">_DGEEV</code></a> which first reduces the input matrix to upper Hessenberg form by means of orthogonal similarity transformations. The QR algorithm is then used to further reduce the matrix to upper quasi-triangular Schur form, \(\mathbf{T}\), with 1 by 1 and 2 by 2 blocks on the main diagonal. The eigenvalues are computed from \(\mathbf{T}\).</p><p>For most applications this will produce very accurate eigenvalues, but when a problem is ill-conditioned, or a small change to the input matrix results in a significant change to the eigenvalues; more numerically stable methods are required. Failing this, higher working precision is required such as quadruple (32-digit), octuple (64-digit) or even arbitrary precision. If you are losing precision in a calculation it is always advised to first analyse the methods and algorithms you are using to see if they can be improved. Only after doing this is it desirable to increase the working precision. Extended precision calculations take <strong>significantly</strong> longer than double precision calculations as they are run in software rather than on hardware.</p><p>Increasing precision is simple in python with the use of the <a href="http://mpmath.org/">mpmath</a> library. Note that this library is <strong>incredibly</strong> slow for large matrices, so is best avoided for most applications. The following code calculates the same eigenvalues as before, this time at quadruple, 32-digit precision.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">rogues</span> <span class="kn">import</span> <span class="n">lesp</span>
<span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span> 
<span class="kn">from</span> <span class="n">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigvals</span>
<span class="kn">from</span> <span class="n">mpmath</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># Set precision to 32-digit
</span><span class="n">mp</span><span class="p">.</span><span class="n">dps</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">color_palette</span><span class="p">(</span><span class="sh">"</span><span class="s">bright</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Dimension of matrix
</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># Lesp matrix
</span><span class="n">A</span> <span class="o">=</span> <span class="nf">lesp</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c1"># Transpose matrix A
</span><span class="n">AT</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">T</span>
<span class="c1"># Calculate eigenvalues of A
</span><span class="n">Aev</span><span class="p">,</span> <span class="n">Eeg</span> <span class="o">=</span> <span class="n">mp</span><span class="p">.</span><span class="nf">eig</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="c1"># Calculate eigenvalues of A^T
</span><span class="n">ATev</span><span class="p">,</span> <span class="n">ETeg</span> <span class="o">=</span> <span class="n">mp</span><span class="p">.</span><span class="nf">eig</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">AT</span><span class="p">))</span>
<span class="c1"># Extract real and imaginary parts of A
</span><span class="n">A_X</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Aev</span><span class="p">]</span>
<span class="n">A_Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Aev</span><span class="p">]</span>
<span class="c1"># Extract real and imaginary parts of A^T
</span><span class="n">AT_X</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ATev</span><span class="p">]</span>
<span class="n">AT_Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ATev</span><span class="p">]</span>

<span class="c1"># Plot
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">A_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">A_Y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\mathbf{A}$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">AT_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">AT_Y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\mathbf{A}^T$</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># Give axis labels
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">real</span><span class="sh">'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">imag</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># Draw legend
</span><span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">pyplot</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></table></code></div></div><p>This produces the following plot of the eigenvalues for a \(100 \times 100 \) matrix.</p><p><a href="/assets/img/Lesp_mpmath.png" class="popup img-link shimmer"><img src="/assets/img/Lesp_mpmath.png" alt="Desktop View" loading="lazy"></a></p><p>Success! We have shown that the eigenvalues of \(\mathbf{A}\) are equal to the eigenvalues of \(\mathbf{A}^T\), equation (1) and all eigenvalues are real. This particular example highlights a recurring theme within computational studies of quantum systems. Quantum simulations of atoms and molecules regularly involve ill-conditioned standard and generalized eigenvalue problems. Numerically stable algorithms exist for such problems, but these occasionally fail leaving us to brute force the calculation with higher precision to minimize floating point rounding errors.</p><p>The next post will discuss better ways to implement higher precision in numerical calculations.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/science/" class="post-tag no-text-decoration" >Science</a> <a href="/tags/mathematics/" class="post-tag no-text-decoration" >Mathematics</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >Programming</a> <a href="/tags/matrix/" class="post-tag no-text-decoration" >matrix</a> <a href="/tags/eigenvalues/" class="post-tag no-text-decoration" >eigenvalues</a> <a href="/tags/lesp/" class="post-tag no-text-decoration" >lesp</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=T%3ET:%20When%20Double%20Precision%20is%20Not%20Enough%20-%20Dr%20Adam%20Luke%20Baskerville&url=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FLespEigenvalues%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=T%3ET:%20When%20Double%20Precision%20is%20Not%20Enough%20-%20Dr%20Adam%20Luke%20Baskerville&u=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FLespEigenvalues%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fadambaskerville.github.io%2Fposts%2FLespEigenvalues%2F&text=T%3ET:%20When%20Double%20Precision%20is%20Not%20Enough%20-%20Dr%20Adam%20Luke%20Baskerville" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/am1bcc_speedup/">T>T: Turbocharging AM1BCC Charge Calculations</a><li class="text-truncate lh-lg"> <a href="/posts/BuffonNeedle/">T>T: Buffon's Needle: Estimating π using Toothpicks</a><li class="text-truncate lh-lg"> <a href="/posts/HighPrecisionEigenvalues/">T>T: High-Precision Eigenvalue Computations Made Efficient in C++</a><li class="text-truncate lh-lg"> <a href="/posts/DearpyguiCompilation/">T>T: Compiling DearPyGui on Raspberry Pi 32-bit OS</a><li class="text-truncate lh-lg"> <a href="/posts/Introduction-post/">T>T: Introduction</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">science</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">Mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">Programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/chemistry/">chemistry</a> <a class="post-tag btn btn-outline-primary" href="/tags/matplotlib/">matplotlib</a> <a class="post-tag btn btn-outline-primary" href="/tags/length/">length</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/HartreeFockGuide/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1586646000" data-df="ll" > Apr 12, 2020 </time><h4 class="pt-0 my-2">T>T: Hartree Fock Theory in 100 Lines</h4><div class="text-muted"><p>Try the code yourself! Click the following button to launch an ipython notebook on Google Colab which implements the code developed in this post: In a previous post we looked at the hydrogen at...</p></div></div></a></article><article class="col"> <a href="/posts/Variational-Method-Hydrogen/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1579132800" data-df="ll" > Jan 16, 2020 </time><h4 class="pt-0 my-2">T>T: Solving the Hydrogen Atom Variationally</h4><div class="text-muted"><p>Try the code yourself! Click the following button to launch an ipython notebook on Google Colab which implements the code developed in this post: The Problem: We want to solve the Schrödinger ...</p></div></div></a></article><article class="col"> <a href="/posts/PythonSubprocess/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1567033200" data-df="ll" > Aug 29, 2019 </time><h4 class="pt-0 my-2">T>T: Call C++ From Python Without Wrapping</h4><div class="text-muted"><p>The Problem: We want to programmatically find the minimum value of the following simple function \[ f(x,y) = x^2 + y^2 + 3 \tag{1} \] We already know the answer to this, \(\text{min}(f(x,y)) = ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/PythonSubprocess/" class="btn btn-outline-primary" aria-label="Older" ><p>T>T: Call C++ From Python Without Wrapping</p></a> <a href="/posts/Variational-Method-Hydrogen/" class="btn btn-outline-primary" aria-label="Newer" ><p>T>T: Solving the Hydrogen Atom Variationally</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/SciBaskerville">Adam Baskerville</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">science</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/mathematics/">Mathematics</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">Programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/science/">Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/tags/chemistry/">chemistry</a> <a class="post-tag btn btn-outline-primary" href="/tags/matplotlib/">matplotlib</a> <a class="post-tag btn btn-outline-primary" href="/tags/length/">length</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
